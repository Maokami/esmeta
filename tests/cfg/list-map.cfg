def map(list: List, f: Function) {
  1: let clist = (copy list)[#1] -> 2
  2: if (= clist.length 0) then 3 else 4
  3: %0 = clist -> 9
  4: let hd = (pop < clist) -> 5
  5: call fhd = f(hd) -> 6
  6: call ftl = clo<map>(clist, f) -> 7
  7: push fhd > ftl -> 8
  8: %0 = ftl -> 9
  9: return %0
}

def double(i: int) {
  1: return (* i 2)
}

1: let list = (new [1, 2, 3, 4, 5])[#1]
2: call doublelist = clo<map>(list, clo<double>)
3: {
  assert (= doublelist[0] 2)
  assert (= doublelist[1] 4)
  assert (= doublelist[2] 6)
  assert (= doublelist[3] 8)
  assert (= doublelist[4] 10)
}
